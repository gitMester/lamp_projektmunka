<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RegisztrÃ¡ciÃ³ â€” KirÃ¡lysÃ¡g</title>
  <link rel="stylesheet" href="regisztracio.css">
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CSILLAGOS Ã‰G
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="stars" id="stars"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     TÅ°ZFÃ‰NY ALUL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="ground-fire-glow"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     VÃRFALAK + TORNYOK
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="castle-walls">

  <!-- BAL FALTÃ–MB -->
  <div class="wall-left">
    <!-- AblakrÃ©sek -->
    <div class="wall-window" style="left:28%;top:22%;"></div>
    <div class="wall-window" style="left:58%;top:38%;"></div>

    <!-- FÃ¡klya -->
    <div class="wall-torch" style="position:absolute;left:72%;top:52%;">
      <div class="wall-torch-glow"></div>
      <div class="wall-torch-flame"></div>
      <div class="wall-torch-pole"></div>
    </div>
    <div class="wall-torch" style="position:absolute;left:32%;top:62%;">
      <div class="wall-torch-glow"></div>
      <div class="wall-torch-flame"></div>
      <div class="wall-torch-pole"></div>
    </div>
  </div>

  <!-- JOBB FALTÃ–MB -->
  <div class="wall-right">
    <div class="wall-window" style="right:28%;top:22%;"></div>
    <div class="wall-window" style="right:60%;top:38%;"></div>

    <div class="wall-torch" style="position:absolute;right:68%;top:52%;">
      <div class="wall-torch-glow"></div>
      <div class="wall-torch-flame"></div>
      <div class="wall-torch-pole"></div>
    </div>
    <div class="wall-torch" style="position:absolute;right:32%;top:62%;">
      <div class="wall-torch-glow"></div>
      <div class="wall-torch-flame"></div>
      <div class="wall-torch-pole"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FÅ JELENET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main class="reg-scene">

  <!-- År megszÃ³lÃ­tÃ¡s fejlÃ©ce -->
  <div class="guard-speech">
    <div class="guard-title">âš” &nbsp; A KirÃ¡lysÃ¡g Kapuja &nbsp; âš”</div>
    <p class="guard-quote">
      â€Ãllj! Ki vagy, vÃ¡ndor, Ã©s mi dolgod van<br>
      e vÃ¡r falain belÃ¼l?"
    </p>
    <div class="guard-divider">
      <span class="guard-divider-icon">âšœ</span>
    </div>
  </div>

  <!-- PERGAMEN KÃRTYA -->
  <div class="register-wrapper">
    <div class="register-card glass-card">

      <!-- Pergamen tekercs teteje -->
      <div class="card-scroll-top">
        <span class="scroll-ornament">âœ¦ &nbsp; âœ¦ &nbsp; âœ¦</span>
      </div>

      <!-- Sarkokban dÃ­szek -->
      <span class="card-corner tl">â§</span>
      <span class="card-corner tr">â§</span>
      <span class="card-corner bl">â§</span>
      <span class="card-corner br">â§</span>

      <!-- År figura â€” lebegÅ‘ badge -->
      <div class="guard-badge" id="guardBadge">
        <div class="guard-speech-bubble" id="guardBubble">
          TÃ¶ltsd ki az okiratot!
        </div>
        <div class="guard-icon">ğŸ›¡ï¸</div>
      </div>

      <!-- KÃ¡rtya belsÅ‘ tartalma -->
      <div class="card-inner">

        <div class="register-header">
          <h1>BemutatkozÃ¡s az Årnek</h1>
          <p>
            Add meg neved Ã©s titkos jelszavadat,<br>
            hogy bejegyezhessenek a vÃ¡r kÃ¶nyveibe.
          </p>
        </div>

        <form id="regForm" class="register-form">

          <div class="form-group">
            <label for="username">Neved a KirÃ¡lysÃ¡gban</label>
            <div class="input-wrap">
              <span class="input-icon">âšœ</span>
              <input
                type="text"
                id="username"
                placeholder="VÃ¡lassz nevet, amelyen ismerjenekâ€¦"
                required
                autocomplete="username"
              >
            </div>
          </div>

          <div class="form-group">
            <label for="password">Titkos jelszÃ³</label>
            <div class="input-wrap">
              <span class="input-icon">ğŸ”‘</span>
              <input
                type="password"
                id="password"
                placeholder="Egy erÅ‘s titkot, amelyet csak te ismerszâ€¦"
                required
                autocomplete="new-password"
              >
            </div>
          </div>

          <button type="submit" class="btn-register">
            BejegyzÃ©s kÃ©rÃ©se
          </button>

        </form>

        <div id="uzenet" class="message" role="alert" aria-live="polite"></div>

        <div class="register-footer">
          <p>
            MÃ¡r ismernek a kapunÃ¡l?
            <a href="bejelentkezes.html">LÃ©pj be a vÃ¡rba</a>
          </p>
        </div>

      </div><!-- /.card-inner -->

      <!-- Pergamen tekercs alja -->
      <div class="card-scroll-bottom">
        <span class="scroll-ornament">âœ¦ &nbsp; âœ¦ &nbsp; âœ¦</span>
      </div>

    </div><!-- /.register-card -->
  </div><!-- /.register-wrapper -->

</main>

<!-- Talaj csÃ­k -->
<div class="ground-strip"></div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CSILLAGOK GENERÃLÃSA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(function() {
  const container = document.getElementById('stars');
  const count = 90;
  for (let i = 0; i < count; i++) {
    const star = document.createElement('div');
    star.className = 'star';
    const size = Math.random() * 2.2 + 0.4;
    const x = Math.random() * 100;
    const y = Math.random() * 65;
    const dur = (Math.random() * 3 + 2).toFixed(1) + 's';
    const del = (Math.random() * 4).toFixed(1) + 's';
    const a1 = (Math.random() * 0.3 + 0.1).toFixed(2);
    const a2 = (Math.random() * 0.5 + 0.5).toFixed(2);
    Object.assign(star.style, {
      width: size + 'px', height: size + 'px',
      left: x + '%', top: y + '%',
      '--sd': dur, '--sdo': del,
      '--sa': a1, '--sb': a2,
    });
    container.appendChild(star);
  }
})();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FORM LOGIKA + ÅR REAKCIÃ“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const form    = document.getElementById('regForm');
const uzenet  = document.getElementById('uzenet');
const bubble  = document.getElementById('guardBubble');
const usrInput = document.getElementById('username');
const pwdInput = document.getElementById('password');

const guardLines = {
  idle:    'TÃ¶ltsd ki az okiratot!',
  typing:  'Hmmâ€¦ figyelemâ€¦',
  name:    'Nem rossz nÃ©v, vÃ¡ndor.',
  password:'JÃ³, jÃ³ â€” legyen erÅ‘s a jelszÃ³!',
  sending: 'â€¦Ãtadom a fÅ‘Ã­rnoknakâ€¦',
  ok:      'âœ¦ Bejegyezve! Ãœdv a vÃ¡rban!',
  error:   'âœ— Valami gyanÃºs ittâ€¦',
};

function showBubble(msg, duration = 3000) {
  bubble.textContent = msg;
  bubble.style.opacity = '1';
  bubble.style.transform = 'translateY(0)';
  if (duration > 0) {
    clearTimeout(showBubble._t);
    showBubble._t = setTimeout(() => {
      bubble.style.opacity = '0';
      bubble.style.transform = 'translateY(6px)';
    }, duration);
  }
}

usrInput.addEventListener('focus', () => showBubble(guardLines.typing, 0));
usrInput.addEventListener('blur',  () => {
  if (usrInput.value.trim()) showBubble(guardLines.name);
  else bubble.style.opacity = '0';
});
pwdInput.addEventListener('focus', () => showBubble(guardLines.password, 0));
pwdInput.addEventListener('blur',  () => { bubble.style.opacity = '0'; });

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const username = usrInput.value.trim();
  const password = pwdInput.value;

  if (!username || !password) {
    uzenet.textContent = 'Minden mezÅ‘t ki kell tÃ¶ltened, vÃ¡ndor.';
    uzenet.className = 'message';
    showBubble(guardLines.error);
    return;
  }

  uzenet.textContent = '';
  showBubble(guardLines.sending, 0);

  try {
    const res = await fetch('regisztracio.php', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, password }),
    });

    const data = await res.json();

    if (data.success) {
      uzenet.textContent = 'âœ¦ Sikeresen bejegyeztek a vÃ¡r kÃ¶nyveibe!';
      uzenet.className = 'message success';
      showBubble(guardLines.ok, 6000);
      form.reset();
      setTimeout(() => { window.location.href = 'bejelentkezes.html'; }, 2200);
    } else {
      uzenet.textContent = data.message || 'Valami fÃ©lrement, vÃ¡ndor.';
      uzenet.className = 'message';
      showBubble(guardLines.error);
    }
  } catch {
    uzenet.textContent = 'A vÃ¡r hÃ­rvivÅ‘i nem Ã©rhetÅ‘k el. PrÃ³bÃ¡lkozz Ãºjra.';
    uzenet.className = 'message';
    showBubble(guardLines.error);
  }
});
</script>

</body>
</html>
